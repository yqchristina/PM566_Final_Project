chol_function[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
chol_function[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
chol_function[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
chol_function %>%
plot_ly(x=~Organelle, y=~Mass,
type= 'scatter', mode = 'markers', color=~Gene_name,
hoverinfo='text',
text=~Gene_name)
#ggplot(chol_function) +
#  geom_point(mapping = aes(x = Organelle, y = Mass, color = Gene_name), size = 3) +
#  xlab("Subcellular Location") + ylab ("Mass (Dalton)") + ggtitle("Subcellular Location of #Cholesteroland Steroid Related Brain CYP450s")
chol_function[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
chol_function[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
chol_function[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
chol_function[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
chol_function %>%
plot_ly(x=~Organelle, y=~Mass,
type= 'scatter', mode = 'markers', color=~Gene_name,
hoverinfo='text',
text=~Gene_name) %>%
layout(title = "Subcellular Location of Cholesterol and Steroid Related Brain CYP450s",
yaxis = list(title = "Mass (Dalton)"), xaxis = list(title = "Subcellular Location"),
hovermode = "compare")
#ggplot(chol_function) +
#  geom_point(mapping = aes(x = Organelle, y = Mass, color = Gene_name), size = 3) +
#  xlab("Subcellular Location") + ylab ("Mass (Dalton)") + ggtitle("Subcellular Location of #Cholesteroland Steroid Related Brain CYP450s")
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
top_level_structure = top_level_structure_name,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol", "top_level_structure_name","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
length(unique(averages_higher$gene_name))
averages_higher %>%
plot_ly(x=~top_level_structure, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, sep = "<br>"))
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
View(combined)
View(combined)
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined_chol[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined_chol[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined_chol[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined_chol %>%
plot_ly(x=~Orgnanelle, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, sep = "<br>"))
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined_chol[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined_chol[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined_chol[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined_chol %>%
plot_ly(x=~Organelle, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, sep = "<br>"))
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined_chol[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined_chol[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined_chol[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined_chol %>%
plot_ly(x=~Organelle, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(Gene_name, ":", sep=""), avg, sep = "<br>"))
View(chol_function)
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined_chol[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined_chol[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined_chol[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined_chol %>%
plot_ly(x=~Organelle, y=~avg,
type= 'scatter', mode = 'markers', color=~Gene_name,
hoverinfo='text',
text=~paste(paste(Gene_name, ":", sep=""), avg, sep = "<br>"))
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined_chol[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined_chol[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined_chol[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined_chol %>%
plot_ly(x=~Organelle, y=~Gene_name,
type= 'scatter', mode = 'markers', color=~top_level_structure,
hoverinfo='text',
text=~paste(paste(Gene_name, ":", sep=""), avg, sep = "<br>"))
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined_chol[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined_chol[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined_chol[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined_chol %>%
plot_ly(x=~Organelle, y=~Gene_name,
type= 'scatter', mode = 'markers', color=~donor_age,
hoverinfo='text',
text=~paste(paste(Gene_name, ":", sep=""), avg, sep = "<br>"))
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = TRUE, all.y = FALSE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined_chol[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined_chol[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined_chol[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined_chol %>%
plot_ly(x=~Organelle, y=~Gene_name,
type= 'scatter', mode = 'markers',
hoverinfo='text',
text=~paste(paste(Gene_name, ":", sep=""), avg, sep = "<br>"))
View(combined_chol)
length(unique(combined_chol$gene_name))
length(unique(combined_chol$Gene_name))
combined_chol2 <- unique(combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"])
interest2 <- chol_function[, .(Gene_name, Protein_name, Mass, Length, Organelle)]
View(interest2)
View(averages_higher)
combined <- merge(cyp450,averages_higher, by.x = "Gene_name", by.y = "gene_name", all.x = FALSE, all.y = TRUE)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined_chol[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined_chol[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined_chol[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined_chol %>%
plot_ly(x=~Organelle, y=~Gene_name,
type= 'scatter', mode = 'markers',
hoverinfo='text',
text=~paste(paste(Gene_name, ":", sep=""), avg, sep = "<br>"))
View(combined_chol)
length(unique(combined_chol$Gene_name))
combined_chol2 <- combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"]
interest2 <- chol_function[, .(Gene_name, Protein_name, Mass, Length, Organelle)]
View(interest2)
combined_chol2 <- combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"]
interest2 <- combined_chol2[, .(Gene_name, Protein_name, Mass, Length, Organelle)]
combined_chol2 <- combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"]
interest2 <- combined_chol2[, .(Gene_name, Mass, Length, Organelle)]
combined_chol2 <- combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"]
interest2 <- combined_chol2[, .(Gene_name, Mass, Organelle)]
View(interest2)
combined_chol2 <- unique(combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"])
interest2 <- combined_chol2[, .(Gene_name, Mass, Organelle)]
View(interest2)
combined_chol2 <- unique(combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"])
interest2 <- combined_chol2[, .(Gene_name, Mass, Organelle)]
knitr::kable(interest2)
View(combined_chol2)
options(scipen = 1, digits = 2)
library(data.table)
library(tidyverse)
library(tidytext)
library(ggplot2)
library(tidyr)
library(tibble)
library(dplyr)
library(plotly)
library(DT)
library(knitr)
opts_chunk$set(
warning = FALSE,
message = FALSE,
eval=TRUE,
echo = TRUE,
cache = FALSE,
fig.width = 9,
fig.align = 'center',
fig.asp = 0.618,
out.width = "700px")
averages_higher %>%
plot_ly(x=~top_level_structure, y=~avg,
type= 'scatter', mode = 'markers', color=~donor_age,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, sep = "<br>"))
combined <- merge(cyp450,microarray, by.x = "Gene_name", by.y = "gene-symbol", all.x = FALSE, all.y = TRUE)
chol_function[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
chol_function[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
chol_function[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
chol_function[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
chol_function %>%
plot_ly(x=~Organelle, y=~Mass,
type= 'scatter', mode = 'markers', color=~Gene_name,
hoverinfo='text',
text=~Gene_name) %>%
layout(title = "Subcellular Location of Cholesterol and Steroid Related Brain CYP450s",
yaxis = list(title = "Mass (Dalton)"), xaxis = list(title = "Subcellular Location"),
hovermode = "compare")
View(cyp450)
chol_function[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
chol_function[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
chol_function[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
chol_function[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
chol_function %>%
plot_ly(x=~Organelle, y=~Mass,
type= 'scatter', mode = 'markers', color=~Gene_name,
hoverinfo='text',
text=~Protein_name) %>%
layout(title = "Subcellular Location of Cholesterol and Steroid Related Brain CYP450s",
yaxis = list(title = "Mass (Dalton)"), xaxis = list(title = "Subcellular Location"),
hovermode = "compare")
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
View(averages)
View(averages_higher)
View(cyp450)
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers',
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, sep = "<br>"))
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
combined <- merge(averages_higher, cyp450, by.x = gene_name, by.y = Gene_name, all.x=TRUE, all.y=FALSE)
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
combined <- merge(averages_higher, cyp450, by.x = `gene-symbol`, by.y = Gene_name, all.x=TRUE, all.y=FALSE)
View(averages_higher)
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
combined <- merge(averages_higher, cyp450, by.x = gene_name, by.y = Gene_name, all.x=TRUE, all.y=FALSE)
View(averages_higher)
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
combined <- merge(averages_higher, cyp450, by.x = "gene_name", by.y = "Gene_name", all.x=TRUE, all.y=FALSE)
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers',
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, sep = "<br>"))
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name
hoverinfo='text',
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, sep = "<br>"))
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, sep = "<br>")) %>%
layout(title = "Expression of CYP450s with Higher or Equal Expression than CYP11A1 in the Brain",
yaxis = list(title = "Average expression (log2)"), xaxis = list(title = "Donor age"),
hovermode = "compare")
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, paste("Subcellular location: ", Organelle) sep = "<br>")) %>%
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, paste("Subcellular location: ", Organelle), sep = "<br>")) %>%
layout(title = "Expression of CYP450s with Higher or Equal Expression than CYP11A1 in the Brain",
yaxis = list(title = "Average expression (log2)"), xaxis = list(title = "Donor age"),
hovermode = "compare")
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
combined <- merge(averages_higher, cyp450, by.x = "gene_name", by.y = "Gene_name", all.x=TRUE, all.y=FALSE)
combined[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, paste("Subcellular location: ", Organelle), sep = "<br>")) %>%
layout(title = "Expression of CYP450s with Higher or Equal Expression than CYP11A1 in the Brain",
yaxis = list(title = "Average expression (log2)"), xaxis = list(title = "Donor age"),
hovermode = "compare")
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'lines', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, paste("Subcellular location: ", Organelle), sep = "<br>")) %>%
layout(title = "Expression of CYP450s with Higher or Equal Expression than CYP11A1 in the Brain",
yaxis = list(title = "Average expression (log2)"), xaxis = list(title = "Donor age"),
hovermode = "compare")
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, paste("Subcellular location: ", Organelle), sep = "<br>")) %>%
layout(title = "Expression of CYP450s with Higher or Equal Expression than CYP11A1 in the Brain",
yaxis = list(title = "Average expression (log2)"), xaxis = list(title = "Donor age"),
hovermode = "compare")
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
View(combined_chol)
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
combined <- merge(averages_higher, cyp450, by.x = "gene_name", by.y = "Gene_name", all.x=TRUE, all.y=FALSE)
combined[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined <- stringr::str_remove_all(combined$donor_age, "[[:space:]]years")
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
combined <- merge(averages_higher, cyp450, by.x = "gene_name", by.y = "Gene_name", all.x=TRUE, all.y=FALSE)
combined[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined$donor_age <- stringr::str_remove_all(combined$donor_age, "[[:space:]]years")
View(combined)
averages <- unique(microarray[, .(
gene_name = `gene-symbol`,
donor_age = donor_age,
avg = mean(expression, na.rm = TRUE)
), by = c("gene-symbol","donor_id")])
averages <- averages[order(-avg),]
cyp11a1_avg <- mean(averages[grep("CYP11A1", `gene-symbol`)]$avg, na.rm = TRUE)
averages_higher <- averages[avg >= cyp11a1_avg]
combined <- merge(averages_higher, cyp450, by.x = "gene_name", by.y = "Gene_name", all.x=TRUE, all.y=FALSE)
combined[, ER := grepl("endoplasmic\\sreticulum",Subcellular_location)]
combined[, Mitochondria := grepl("mitochondria|mitochondrion", Subcellular_location)]
combined[, Cytoplasm := grepl("cytoplasm|cytoplasmic", Subcellular_location)]
combined[, Organelle := ifelse(ER&Mitochondria, "Both ER and Mitochondria",
ifelse(Mitochondria, "Mitochondria Only", "ER Only"))]
combined$donor_age <- as.integer(stringr::str_remove_all(combined$donor_age, "[[:space:]]years"))
View(combined)
combined %>%
plot_ly(x=~donor_age, y=~avg,
type= 'scatter', mode = 'markers', color=~gene_name,
hoverinfo='text',
text=~paste(paste(gene_name, ":", sep=""), avg, paste("Subcellular location: ", Organelle), sep = "<br>")) %>%
layout(title = "Expression of CYP450s with Higher or Equal Expression than CYP11A1 in the Brain",
yaxis = list(title = "Average expression (log2)"), xaxis = list(title = "Donor age"),
hovermode = "compare")
combined_chol <- unique(combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"])
combined_chol <- unique(combined_chol[, .(
Gene_name = Gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"])
combined_chol <- unique(combined_chol[, .(
gene_name = gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"])
View(combined)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
datatable()
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
datatable(combined_chol)
View(combined_chol)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
datatable(combined_chol[,.(gene_name,donor_id,donor_age,avg,Protein_name, Length, Mass, Organelle)])
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
datatable(combined_chol[,.(gene_name,donor_age,avg,Protein_name, Length, Mass, Organelle)])
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol <- rename(combined_chol,"avg"="avg_expression")
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol <- dplyr::rename(combined_chol,"avg"="avg_expression")
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol <- dplyr::rename(combined_chol,avg=avg_expression)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol <- dplyr::rename(combined_chol,avg==avg_expression)
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
combined_chol <- dplyr::rename(combined_chol,"avg"=="avg_expression")
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
datatable(combined_chol[,.(gene_name,donor_age,avg,Protein_name, Length, Mass, Organelle)])
combined_chol <- unique(combined_chol[, .(
gene_name = gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "Gene_name"])
combined_chol <- combined[grep("cholesterol|steroid|hormone", Function),]
datatable(combined_chol[,.(gene_name,donor_id,donor_age,avg,Protein_name, Length, Mass, Organelle)])
combined_chol <- unique(combined_chol[, .(
gene_name = gene_name,
Mass = Mass,
Function = Function,
Organelle = Organelle,
Expression = mean(avg, na.rm = TRUE)
), by= "gene_name"])
interest2 <- combined_chol[, .(gene_name, Mass, Organelle)]
knitr::kable(interest2)
